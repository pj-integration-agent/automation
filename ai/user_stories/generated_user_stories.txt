**User Stories – Aplicação Bancos Nacionais**

| # | User Story |
|---|------------|
| **US01** | **Como** usuário do módulo “Bancos Nacionais”, **eu quero** registrar um novo banco preenchendo todos os campos obrigatórios **para** que o sistema mantenha um inventário único e confiável de bancos associados à nossa organização. |
| **US02** | **Como** usuário do módulo “Bancos Nacionais”, **eu quero** editar as informações de um banco já cadastrado (exceto o “Código”) **para** que possa atualizar dados quando houver mudanças de controle, inscrição SBP ou descrição. |

---

## US01 – Cadastro de Banco

### Descrição
O usuário deverá ser capaz de abrir a tela “Novo Banco”, preencher os campos obrigatórios, validar as regras de negócio e gravar o registro. Cada campo tem requisitos específicos:

| Campo | Obrigatório | Validação |
|-------|-------------|-----------|
| Código | Sim | - Não pode ser duplicado (único na tabela). |
| Descrição do Banco | Sim | - Texto livre, mínimo 3 caracteres. |
| Apelido | Sim | - Texto livre, mínimo 2 caracteres. |
| Número de Inscrição no SBP | Sim | - Deve ser numérico, 8 dígitos. |
| Banco Controlador | Sim | - Seleção de um item da lista pre‑carregada. |
| CNPJ | Sim | - Deve seguir o padrão `00.000.000/0000-00` e existir no cadastro de CNPJ do sistema. |

O usuário clica em **Salvar**. Se todos os critérios forem atendidos, o registro é persistido e uma mensagem de sucesso é exibida. Caso contrário, os campos inválidos são destacados e a operação não é concluída.

### Critérios de Aceitação

1. Ao clicar em **Novo**, a tela de cadastro aparece com todos os campos vazios e visíveis.
2. O usuário deve conseguir preencher *Código*, *Descrição*, *Apelido*, *Número de Inscrição no SBP*, selecionar *Banco Controlador* e digitar um *CNPJ* válido.
3. O sistema impede salvar se algum campo obrigatório estiver vazio.
4. O sistema impede salvar se o *Código* já existir em outro registro.
5. O sistema valida o formato do *CNPJ* e verifica sua existência no banco de dados; se inválido, exibe mensagem de erro.
6. Após o clique em **Salvar**, se todos os campos forem válidos, o banco é salvo, a tela fecha e uma mensagem “Banco cadastrado com sucesso” é mostrada.
7. Se houver erro, a tela permanece aberta, os campos inválidos são destacados e a mensagem de erro específica é exibida.

---

## US02 – Edição de Banco

### Descrição
O usuário deve conseguir abrir um registro já existente, alterar qualquer campo exceto o *Código*, validar as regras e salvar as alterações. O *Código* permanece imutável para garantir a integridade do identificador único.

### Critérios de Aceitação

1. Ao abrir a lista de bancos, o usuário pode selecionar um registro e clicar em **Editar**, que abre a tela com os dados pré‑preenchidos.
2. O campo **Código** é exibido apenas como texto (não editável).
3. O usuário pode alterar *Descrição*, *Apelido*, *Número de Inscrição no SBP*, *Banco Controlador* e *CNPJ*.
4. O sistema valida cada campo conforme regras de US01 (exceto duplicidade de Código).
5. Se algum campo for inválido, o sistema impede salvar e exibe mensagem de erro.
6. Após clicar em **Salvar** com dados válidos, o registro é atualizado, a tela fecha e uma mensagem “Banco atualizado com sucesso” é exibida.
7. Se o usuário tentar alterar o **Código** (por meio de manipulação direta da página ou API), o sistema bloqueia a alteração e mantém o valor original.

---

## BDD – Cenários Positivos e Negativos

### US01 – Cadastro de Banco

```gherkin
Feature: Cadastro de banco

  Scenario: Cadastro bem-sucedido com todos os campos válidos
    Dado que o usuário está na tela de cadastro de bancos
    Quando o usuário preenche "Código" com "BN001"
    E preenche "Descrição" com "Banco Nacional ABC"
    E preenche "Apelido" com "ABC"
    E preenche "Número de Inscrição no SBP" com "12345678"
    E seleciona "Banco Controlador" como "Controlador X"
    E preenche "CNPJ" com "12.345.678/0001-90"
    Quando o usuário clica em "Salvar"
    Então o banco é persistido no banco de dados
    E a tela fecha
    E a mensagem "Banco cadastrado com sucesso" é exibida

  Scenario: Erro ao tentar cadastrar com Código duplicado
    Dado que já existe um banco com "Código" = "BN001"
    E o usuário está na tela de cadastro de bancos
    Quando o usuário preenche "Código" com "BN001"
    E preenche os demais campos com valores válidos
    Quando o usuário clica em "Salvar"
    Então a mensagem "Código já cadastrado. Por favor, use outro código." é exibida
    E o banco não é salvo

  Scenario: Erro ao cadastrar sem preencher campo obrigatório
    Dado que o usuário está na tela de cadastro de bancos
    Quando o usuário preenche "Código" com "BN002"
    E deixa "Descrição" em branco
    E preenche os demais campos com valores válidos
    Quando o usuário clica em "Salvar"
    Então a mensagem "Descrição é obrigatória." é exibida
    E o banco não é salvo

  Scenario: Erro ao cadastrar com CNPJ inválido
    Dado que o usuário está na tela de cadastro de bancos
    Quando o usuário preenche "CNPJ" com "12.345.678/0001-99" (número inexistente)
    E preenche os demais campos com valores válidos
    Quando o usuário clica em "Salvar"
    Então a mensagem "CNPJ não encontrado no cadastro." é exibida
    E o banco não é salvo
```

### US02 – Edição de Banco

```gherkin
Feature: Edição de banco

  Scenario: Edição bem-sucedida de campos permitidos
    Dado que existe um banco com "Código" = "BN003"
    E o usuário está na lista de bancos
    Quando o usuário clica em "Editar" do banco "BN003"
    Então a tela de edição abre com dados pré‑preenchidos
    E o campo "Código" está exibido como somente‑leitura
    Quando o usuário altera "Descrição" para "Banco Nacional XYZ"
    E altera "Apelido" para "XYZ"
    E altera "Número de Inscrição no SBP" para "87654321"
    E seleciona "Banco Controlador" como "Controlador Y"
    E altera "CNPJ" para "98.765.432/0001-01"
    Quando o usuário clica em "Salvar"
    Então o banco "BN003" é atualizado no banco de dados
    E a tela fecha
    E a mensagem "Banco atualizado com sucesso" é exibida

  Scenario: Tentar alterar o Código (campo não editável)
    Dado que existe um banco com "Código" = "BN004"
    E o usuário está na lista de bancos
    Quando o usuário clica em "Editar" do banco "BN004"
    Então o campo "Código" é somente‑leitura
    Quando o usuário tenta modificar o valor de "Código" para "BN005"
    E clica em "Salvar"
    Então a mensagem "Código não pode ser alterado." é exibida
    E o banco continua com "Código" = "BN004"

  Scenario: Erro ao salvar edição com campo obrigatório em branco
    Dado que existe um banco com "Código" = "BN005"
    E o usuário está na lista de bancos
    Quando o usuário clica em "Editar" do banco "BN005"
    E deixa "Apelido" em branco
    Quando o usuário clica em "Salvar"
    Então a mensagem "Apelido é obrigatório." é exibida
    E o banco não é alterado
```

> **Observação**  
> - Todos os testes BDD estão escritos em primeira pessoa e no imperativo, conforme solicitado.  
> - Os cenários positivos garantem que a funcionalidade funcione quando todas as regras forem satisfeitas.  
> - Os cenários negativos validam a robustez das validações e garantem que o sistema se comporte corretamente em situações de erro.  
> - Cada história possui critérios claros de aceitação que podem ser diretamente traduzidos em testes automatizados.