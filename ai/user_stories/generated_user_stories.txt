## User Stories (US)

| **Código** | **User Story** | **Descrição detalhada** | **Critérios de aceite** |
|------------|----------------|--------------------------|--------------------------|
| **US01** | **Como usuário do sistema de bancos, eu quero abrir a tela de cadastro de banco ao clicar em “Novo” para iniciar o registro de um novo banco.** | Quando o usuário clica no botão “Novo”, o sistema deve exibir uma tela limpa com todos os campos necessários para a criação de um banco. A tela deve possuir título “Cadastro de Banco” e botões “Salvar” e “Cancelar”. | 1. Ao clicar em “Novo” a tela de cadastro é exibida. <br> 2. A tela contém os campos: Código, Descrição do Banco, Apelido, Número de inscrição no SBP, Banco controlador, CNJP. <br> 3. A tela possui os botões “Salvar” e “Cancelar”. <br> 4. O botão “Cancelar” fecha a tela e volta para a lista de bancos. |
| **US02** | **Como usuário do sistema de bancos, eu quero que todos os campos sejam obrigatórios ao salvar para garantir que o cadastro contenha dados completos.** | Cada campo da tela de cadastro deve exibir uma indicação visual de obrigatoriedade (ex.: asterisco vermelho) e o sistema deve validar a presença de dados antes de permitir o envio. | 1. Quando o usuário tenta salvar sem preencher um campo obrigatório, o sistema exibe uma mensagem de erro específica para esse campo. <br> 2. O campo em branco permanece destacado com borda vermelha. <br> 3. Nenhum registro é salvo enquanto houver campos obrigatórios vazios. |
| **US03** | **Como usuário do sistema de bancos, eu quero que o campo “Código” seja único para evitar duplicatas.** | O sistema deve verificar, em tempo real e ao salvar, se o código informado já existe em outro registro ativo. | 1. Ao digitar um código já existente, a tela exibe uma mensagem “Código já cadastrado”. <br> 2. O botão “Salvar” fica desabilitado enquanto houver duplicidade. <br> 3. O usuário pode alterar o código até que seja único. |
| **US04** | **Como usuário do sistema de bancos, eu quero que o campo CNJP seja validado quanto à existência e formato correto.** | A entrada de CNJP deve passar por validação de formato (xx.xxx.xxx/xxxx-xx) e ser conferida em um serviço externo de consulta de CNPJ. | 1. Se o CNJP não seguir o padrão, exibe “Formato de CNJP inválido”. <br> 2. Se o CNJP não existir no cadastro de bancos, exibe “CNJP não encontrado”. <br> 3. O botão “Salvar” fica desabilitado até que o CNJP seja válido e existente. |
| **US05** | **Como usuário do sistema de bancos, eu quero que o campo “Banco controlador” seja um dropdown com bancos já cadastrados, para facilitar a escolha correta.** | O dropdown deve listar apenas bancos que já foram cadastrados e ativos. | 1. O dropdown apresenta pelo menos um banco quando há registros existentes. <br> 2. O usuário pode selecionar um banco controlador dentre os listados. <br> 3. Se não houver bancos cadastrados, o campo exibe “Nenhum banco controlador disponível” e fica desabilitado. |
| **US06** | **Como usuário do sistema de bancos, eu quero salvar o cadastro após preencher todos os campos obrigatórios, recebendo confirmação de sucesso, para concluir o registro.** | O sistema grava o registro no banco de dados e mostra uma mensagem de sucesso. | 1. Ao clicar em “Salvar” com todos os campos válidos, o registro é criado. <br> 2. A tela exibe “Banco cadastrado com sucesso”. <br> 3. O usuário é redirecionado para a lista de bancos e o novo registro aparece na lista. |
| **US07** | **Como usuário do sistema de bancos, eu quero receber mensagens de erro claras quando validações falharem, para poder corrigir rapidamente.** | Todas as mensagens de erro devem indicar a causa e o campo afetado. | 1. Mensagens de erro são exibidas ao lado do campo correspondente. <br> 2. O texto do erro é compreensível e instrui o usuário a corrigir o problema. <br> 3. Mensagens desaparecem quando o erro é corrigido. |

> **Observação:** Cada US cobre apenas um aspecto da funcionalidade para garantir rastreabilidade, não sobreposição de escopo e facilidade de testes.

---

## BDD – Cenários de Teste

### US01 – Navegação para a tela de cadastro

```gherkin
Feature: Acesso à tela de cadastro de banco

  Scenario: Usuário clica em "Novo" e visualiza a tela de cadastro
    Given o usuário está na tela de lista de bancos
    When ele clica no botão "Novo"
    Then a tela de cadastro de banco deve aparecer
    And os campos Código, Descrição do Banco, Apelido, Número de inscrição no SBP, Banco controlador e CNJP devem estar visíveis
    And o título da tela deve ser "Cadastro de Banco"
    And os botões "Salvar" e "Cancelar" devem estar habilitados
```

---

### US02 – Campos obrigatórios

```gherkin
Feature: Validação de campos obrigatórios

  Scenario Outline: Falha ao salvar com campos obrigatórios ausentes
    Given o usuário preenche o campo "<campo>" com "<valor>"
    And o usuário tenta salvar o registro
    Then a mensagem "<mensagem>" deve ser exibida ao lado do campo "<campo>"

  Examples:
    | campo          | valor | mensagem                         |
    | Código         |       | Código é obrigatório             |
    | Descrição do Banco |       | Descrição do Banco é obrigatória |
    | Apelido        |       | Apelido é obrigatório            |
    | Número de inscrição no SBP |       | Número de inscrição no SBP é obrigatório |
    | Banco controlador |       | Banco controlador é obrigatório   |
    | CNJP           |       | CNJP é obrigatório                |
```

---

### US03 – Código único

```gherkin
Feature: Validação de unicidade do Código

  Scenario: Código duplicado impede o salvamento
    Given existe um banco cadastrado com Código "B001"
    And o usuário digita "B001" no campo Código
    Then a mensagem "Código já cadastrado" deve ser exibida
    And o botão "Salvar" deve permanecer desabilitado

  Scenario: Código único permite o salvamento
    Given o usuário digita "B002" no campo Código
    Then nenhum aviso de duplicidade deve aparecer
    And o botão "Salvar" deve estar habilitado
```

---

### US04 – Validação de CNJP

```gherkin
Feature: Validação do CNJP

  Scenario: CNJP com formato inválido
    Given o usuário digita "12345678" no campo CNJP
    Then a mensagem "Formato de CNJP inválido" deve ser exibida
    And o botão "Salvar" deve estar desabilitado

  Scenario: CNJP não existente
    Given o usuário digita "12.345.678/0001-90" no campo CNJP
    And o sistema não encontra o CNJP em seu cadastro
    Then a mensagem "CNJP não encontrado" deve ser exibida
    And o botão "Salvar" deve estar desabilitado

  Scenario: CNJP válido e existente
    Given o usuário digita "12.345.678/0001-90" no campo CNJP
    And o CNJP é encontrado no banco de dados
    Then nenhuma mensagem de erro deve aparecer
    And o botão "Salvar" deve estar habilitado
```

---

### US05 – Seleção do Banco Controlador

```gherkin
Feature: Seleção do banco controlador

  Scenario: Dropdown com bancos existentes
    Given há pelo menos um banco cadastrado como potencial controlador
    When o usuário abre o dropdown "Banco controlador"
    Then os bancos disponíveis devem ser listados

  Scenario: Nenhum banco controlador disponível
    Given não há bancos cadastrados
    Then o campo "Banco controlador" deve exibir "Nenhum banco controlador disponível"
    And o campo deve estar desabilitado
```

---

### US06 – Salvamento com sucesso

```gherkin
Feature: Salvamento de banco com sucesso

  Scenario: Cadastro completo e válido
    Given o usuário preenche todos os campos obrigatórios com valores válidos:
      | Campo                 | Valor                 |
      | Código                | B003                  |
      | Descrição do Banco    | Banco Teste           |
      | Apelido               | BT                    |
      | Número de inscrição no SBP | 123456               |
      | Banco controlador     | Banco Controlador Exemplo |
      | CNJP                  | 12.345.678/0001-90    |
    When o usuário clica em "Salvar"
    Then o banco deve ser salvo no sistema
    And a mensagem "Banco cadastrado com sucesso" deve ser exibida
    And o usuário deve ser redirecionado para a lista de bancos
    And o banco recém‑criado deve aparecer na lista
```

---

### US07 – Mensagens de erro detalhadas

```gherkin
Feature: Mensagens de erro claras e específicas

  Scenario Outline: Exibição de erro ao validar campo
    Given o usuário preenche o campo "<campo>" com "<valor>"
    And o usuário tenta salvar o registro
    Then a mensagem "<mensagem>" deve ser exibida ao lado do campo "<campo>"

  Examples:
    | campo          | valor | mensagem                         |
    | Código         |       | Código é obrigatório             |
    | Código         | B001  | Código já cadastrado             |
    | CNJP           | 111     | Formato de CNJP inválido         |
    | CNJP           | 12.345.678/0001-90 | CNJP não encontrado |
```

---

### Resumo de Prioridade

| US | Prioridade | Justificativa |
|----|------------|---------------|
| US01 | Alta | Necessária para iniciar o processo |
| US02 | Alta | Garante dados completos |
| US03 | Alta | Evita duplicação de registros |
| US04 | Alta | Garante legitimidade do banco |
| US05 | Média | Melhora usabilidade, mas não impede cadastro |
| US06 | Alta | Finaliza o fluxo de negócio |
| US07 | Média | Melhora experiência do usuário |

Esses User Stories e cenários BDD cobrem de forma clara, objetiva e testável todas as funcionalidades e requisitos apresentados, assegurando rastreabilidade e evitando sobreposição de escopo.