**User Story – Cadastro de Bancos Nacionais**  
*(US01)*  

> Como **gestor de bancos nacionais**, eu quero **criar um novo registro de banco** para que o sistema reflita corretamente todas as instituições que operam no nosso ecossistema bancário.  

### Descrição  
A tela de cadastro deve permitir a inserção de um novo banco com os seguintes campos obrigatórios:  
- **Código** – valor único, não pode coincidir com nenhum código já registrado.  
- **Descrição do Banco** – texto livre que descreve o banco.  
- **Apelido** – nome curto ou sigla do banco.  
- **Número de inscrição no SBP** – número de inscrição no Sistema Brasileiro de Pagamentos.  
- **Banco controlador** – seleção de uma lista pre‑carregada de bancos controladores.  
- **CNPJ** – deve ser um número de CNPJ válido e existir na base de dados pública.  

Ao clicar em **Salvar**, o sistema deve validar todos os campos, persistir o registro e exibir uma mensagem de sucesso. Se houver algum erro, o usuário deve receber feedback específico para cada campo.

### Critérios de Aceitação  
| # | Critério |
|---|----------|
| 1 | O botão **Novo** abre a tela de cadastro em branco. |
| 2 | Todos os campos listados acima são marcados como obrigatórios. |
| 3 | O campo **Código** aceita apenas valores numéricos/alfanuméricos e não permite duplicatas; ao inserir um código já existente o sistema exibe “Código já cadastrado”. |
| 4 | O campo **CNPJ** valida tanto a formatação (xx.xxx.xxx/xxxx‑xx) quanto a existência real (consulta a API de CNPJs). Em caso de inválido exibe “CNPJ inválido ou inexistente”. |
| 5 | O campo **Banco controlador** apresenta uma lista suspensa preenchida automaticamente ao abrir a tela. |
| 6 | Ao clicar em **Salvar**, se todos os dados forem válidos, o registro é salvo e o usuário recebe “Banco cadastrado com sucesso”. |
| 7 | Se houver qualquer erro de validação, o usuário permanece na tela de cadastro e recebe mensagens de erro correspondentes a cada campo. |

---

## BDD – Cenários Positivos & Negativos (US01)

```gherkin
# Cenário Positivo – Cadastro bem-sucedido
Dado que o usuário está na tela de cadastro de banco
Quando ele preencher o campo "Código" com "BN001"
E inserir a "Descrição do Banco" como "Banco Nacional de Teste"
E colocar o "Apelido" como "BN Teste"
E inserir o "Número de inscrição no SBP" como "123456"
E selecionar "Banco Controlador X" na lista
E digitar um CNPJ válido e existente "12.345.678/0001-95"
E clicar em "Salvar"
Então o sistema deve exibir a mensagem "Banco cadastrado com sucesso"
E o registro deve aparecer na lista de bancos

# Cenário Negativo – Código duplicado
Dado que já existe um banco cadastrado com código "BN001"
Quando o usuário tenta criar outro banco com o mesmo código
E preencher os demais campos corretamente
E clicar em "Salvar"
Então o sistema deve exibir a mensagem "Código já cadastrado"

# Cenário Negativo – Campo obrigatório vazio
Dado que o usuário está na tela de cadastro de banco
Quando ele deixa o campo "Descrição do Banco" em branco
E preenche todos os demais campos corretamente
E clica em "Salvar"
Então o sistema deve exibir a mensagem "Descrição do Banco é obrigatória"

# Cenário Negativo – CNPJ inválido
Dado que o usuário está na tela de cadastro de banco
Quando ele insere um CNPJ no formato inválido "123"
E preenche todos os demais campos corretamente
E clica em "Salvar"
Então o sistema deve exibir a mensagem "CNPJ inválido ou inexistente"
```

---

**User Story – Edição de Bancos Nacionais**  
*(US02)*  

> Como **gestor de bancos nacionais**, eu quero **editar um registro existente** (exceto o código) para manter as informações atualizadas e corretas.  

### Descrição  
Ao selecionar um banco na lista e escolher a opção **Editar**, a tela deve carregar os dados atuais do banco. O campo **Código** permanece **não editável**. Os demais campos podem ser alterados, sujeitando‑se às mesmas regras de validação do cadastro (campos obrigatórios, CNPJ válido, lista de controlador, etc.). Após a alteração, o usuário clica em **Salvar** e o sistema persiste as mudanças, mostrando mensagem de sucesso.

### Critérios de Aceitação  
| # | Critério |
|---|----------|
| 1 | O usuário pode abrir um banco existente clicando em **Editar**. |
| 2 | Na tela de edição, o campo **Código** está bloqueado (não editável). |
| 3 | Os campos obrigatórios continuam obrigatórios e mantêm a mesma lógica de validação (ex.: CNPJ válido). |
| 4 | O usuário pode alterar qualquer campo exceto o Código e salvar. |
| 5 | Após salvar, o sistema exibe “Banco atualizado com sucesso” e reflete as mudanças na lista. |
| 6 | Se o usuário tentar alterar o **Código** (por meio de manipulação direta da UI), o sistema ignora a mudança e mantém o valor original. |
| 7 | Caso haja erro de validação, o sistema exibe mensagem específica para cada campo e impede a gravação. |

---

## BDD – Cenários Positivos & Negativos (US02)

```gherkin
# Cenário Positivo – Edição bem-sucedida
Dado que o usuário abriu o banco com código "BN002" para edição
Quando ele altera a "Descrição do Banco" para "Banco Nacional Atualizado"
E mantém o CNPJ "98.765.432/0001-10" (válido)
E seleciona outro "Banco Controlador Y"
E clica em "Salvar"
Então o sistema deve exibir a mensagem "Banco atualizado com sucesso"
E o banco deve aparecer na lista com as informações atualizadas

# Cenário Negativo – Tentativa de alterar Código
Dado que o usuário abriu o banco com código "BN003" para edição
Quando ele tenta mudar o campo "Código" para "BN004"
E salva
Então o sistema deve manter o código original "BN003" e exibir a mensagem "Código não pode ser alterado"

# Cenário Negativo – Campo obrigatório vazio durante edição
Dado que o usuário abriu o banco com código "BN004" para edição
Quando ele limpa o campo "Apelido"
E clica em "Salvar"
Então o sistema deve exibir a mensagem "Apelido é obrigatório"

# Cenário Negativo – CNPJ inválido em edição
Dado que o usuário abriu o banco com código "BN005" para edição
Quando ele altera o campo "CNPJ" para "123"
E clica em "Salvar"
Então o sistema deve exibir a mensagem "CNPJ inválido ou inexistente"
```

---

### Observações de Rastreabilidade  
| US | Título | Prioridade |
|----|--------|------------|
| US01 | Cadastro de Banco Nacional | Alta |
| US02 | Edição de Banco Nacional | Alta |

Essas User Stories e cenários BDD garantem cobertura completa das funcionalidades de cadastro e edição, com validações cruciais (unicidade de código, validade de CNPJ, obrigatoriedade de campos) e comportamentos esperados, sem sobreposição de escopo e com métricas claras para teste.